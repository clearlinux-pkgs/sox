diff --git a/src/fft4g.c b/src/fft4g.c
index 38a8bcc..4119fc0 100644
--- a/src/fft4g.c
+++ b/src/fft4g.c
@@ -282,6 +282,7 @@ Appendix :
 */
 
 
+#include <stdlib.h>
 #include <math.h>
 #include "fft4g.h"
 
@@ -705,11 +706,14 @@ static void makect(int nc, int *ip, double *c)
 
 /* -------- child routines -------- */
 
+#define MAX_IP 256
 
 static void bitrv2(int n, int *ip0, double *a)
 {
-    int j, j1, k, k1, l, m, m2, ip[256];
+    int j, j1, k, k1, l, m, m2, ip[MAX_IP];
     double xr, xi, yr, yi;
+
+    if (n > MAX_IP) abort();
     
     (void)ip0;
     ip[0] = 0;
@@ -809,9 +813,11 @@ static void bitrv2(int n, int *ip0, double *a)
 
 static void bitrv2conj(int n, int *ip0, double *a)
 {
-    int j, j1, k, k1, l, m, m2, ip[256];
+    int j, j1, k, k1, l, m, m2, ip[MAX_IP];
     double xr, xi, yr, yi;
     
+    if (n > MAX_IP) abort();
+
     (void)ip0;
     ip[0] = 0;
     l = n;
